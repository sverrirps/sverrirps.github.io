$(function(){"use strict";var a=new window.Game($(".GameCanvas"));a.start()}),window.Controls=function(){"use strict";var a=function(){this._didJump=!1,this._didSwim=!1,this._mute=!1,$(window).on("keydown",this._onKeyDown.bind(this)).on("keyup",this._onKeyUp.bind(this)),$(".GameCanvas").on("mousedown touchstart",this._onMouseDown.bind(this)).on("mouseup touchend",this._onMouseUp.bind(this)),$(".MuteButton").on("click",this._onMuteClick.bind(this))};return a.prototype._onKeyDown=function(a){return 32!==a.keyCode||this._didSwim||(this._didJump=!0),32===a.keyCode?(this._didSwim=!0,!1):void 0},a.prototype._onKeyUp=function(a){return 32===a.keyCode?(this._didSwim=!1,!1):void 0},a.prototype._onMouseDown=function(a){this._didSwim=!0},a.prototype._onMouseUp=function(a){this._didSwim=!1},a.prototype._onMuteClick=function(a){var b=document.getElementById("MuteButton"),c=$(".Ocean")[0],d=$(".Loser")[0];"Mute"===b.firstChild.data?(b.firstChild.data="Unmute",this._mute=!0,c.muted=!0,d.muted=!0):(b.firstChild.data="Mute",this._mute=!1,c.muted=!1,d.muted=!1)},a.prototype.didJump=function(){var a=this._didJump;return this._didJump=!1,a},new a}(),window.Game=function(){"use strict";var a=function(a){this.el=a,this.player=new window.Player(this.el.find(".Player"),this),this.moai=new window.Moai(this.el.find(".MoaiObstacle"),this,this.player),this.isPlaying=!1,this.onFrame=this.onFrame.bind(this)};return a.prototype.onFrame=function(){if(this.isPlaying){var a=+new Date/1e3,b=a-this.lastFrame;this.lastFrame=a,this.player.onFrame(b),this.moai.onFrame(b),window.requestAnimationFrame(this.onFrame)}},a.prototype.start=function(){this.reset(),this.lastFrame=+new Date/1e3,window.requestAnimationFrame(this.onFrame),this.isPlaying=!0},a.prototype.reset=function(){var a=document.getElementsByClassName("Floor")[0],b=document.getElementsByClassName("PlayerWings")[0];a.style.WebkitAnimationPlayState="initial",a.style.animationPlayState="initial",b.style.WebkitAnimationPlayState="initial",b.style.animationPlayState="initial",this.player.reset(),this.moai.reset()},a.prototype.gameover=function(){this.isPlaying=!1;var a=document.getElementsByClassName("Floor")[0],b=document.getElementsByClassName("PlayerWings")[0];a.style.WebkitAnimationPlayState="paused",a.style.animationPlayState="paused",b.style.WebkitAnimationPlayState="paused",b.style.animationPlayState="paused";var c=this,d=this.el.find(".Scoreboard");d.addClass("is-visible").find(".Scoreboard-restart").one("click",function(){d.removeClass("is-visible"),c.start()})},a.prototype.WORLD_WIDTH=128,a.prototype.WORLD_HEIGHT=72,a}(),window.Player=function(){"use strict";var a=window.Controls,b=(window.Moai,30),c=10,d=11.5,e=12.8,f=30,g=25,h=1,i=function(a,b){this.el=a,this.game=b,this.pos={x:0,y:0,angle:0},this.playerAlive=!0,this.hasStarted=!1,this.highScore=0,document.getElementById("Highscore").innerHTML=this.highScore};return i.prototype.reset=function(){this.pos.x=f,this.pos.y=g,this.pos.angle=0,this.playerAlive=!0,this.hasStarted=!1,this.nextMaoiNr=0,this.currentScore=0,b=30,document.getElementById("Score").innerHTML=this.currentScore,this.transformPlayer()},i.prototype.onFrame=function(c){if(a._didSwim&&this.hasStarted){if(document.getElementById("ScorePlaying").innerHTML=this.currentScore,!a._mute){var d=$(".Huh")[0];d.paused?d.play():d.currentTime=0}b=10,this.pos.y-=c*(10*b),this.pos.angle>0&&(this.pos.angle=0)}else if(this.hasStarted)b+=h,this.pos.y+=c*b,this.pos.angle<120&&(this.pos.angle+=c*b*4);else{if(!a._didSwim)return;this.hasStarted=!0}this.transformPlayer(),this.checkCollisionWithBounds(),this.checkCollisionWithMoais()},i.prototype.transformPlayer=function(){this.el.css("transform","translate3d("+this.pos.x+"em, "+this.pos.y+"em, 0em) rotate("+this.pos.angle+"deg)"),this.el.css("-moz-transform","translate3d("+this.pos.x+"em, "+this.pos.y+"em, 0em) rotate("+this.pos.angle+"deg)"),this.el.css("-webkit-transform","translate3d("+this.pos.x+"em, "+this.pos.y+"em, 0em) rotate("+this.pos.angle+"deg)")},i.prototype.checkCollisionWithBounds=function(){return this.pos.x<0||this.pos.x+c>this.game.WORLD_WIDTH||this.pos.y<-100||this.pos.y+d>this.game.WORLD_HEIGHT-7?(this.playerAlive=!1,this.playLoserSound(),this.game.gameover()):void 0},i.prototype.checkCollisionWithMoais=function(){for(var a=0;a<this.game.moai.moais.length;a++)if(this.pos.x+c>=this.game.moai.moais[a].upperMoai.pos.x&&this.pos.x<this.game.moai.moais[a].upperMoai.pos.x+e){var b=parseFloat(this.game.moai.el[2*a].style.height),f=this.game.WORLD_HEIGHT-parseFloat(this.game.moai.el[2*a+1].style.height);if(this.pos.y<=b||this.pos.y+d>=f+2)return this.playerAlive=!1,this.playLoserSound(),this.game.gameover();a===this.nextMaoiNr&&(this.currentScore++,document.getElementById("ScorePlaying").innerHTML=this.currentScore,document.getElementById("Score").innerHTML=this.currentScore,this.currentScore>this.highScore&&(this.highScore=this.currentScore,document.getElementById("Highscore").innerHTML=this.highScore),this.nextMaoiNr=(this.nextMaoiNr+1)%this.game.moai.moais.length)}},i.prototype.playLoserSound=function(){if(!a._mute){var b=$(".Loser")[0];b.paused?b.play():b.currentTime=0}},i}(),window.requestAnimationFrame||(window.requestAnimationFrame=function(){"use strict";return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}()),window.Moai=function(){"use strict";var a=10,b=12.8,c=25,d=function(a,b,c){this.el=a,this.game=b,this.hasStarted=!1,this.player=c,this.moais=[{name:"moai1",upperMoai:new e(this.el.find(".Moai"),this.game.WORLD_WIDTH,0,180),lowerMoai:new e(this.el.find(".MoaiReverse"),this.game.WORLD_WIDTH,0,0)},{name:"moai2",upperMoai:new e(this.el.find(".Moai2"),1.4*this.game.WORLD_WIDTH,0,180),lowerMoai:new e(this.el.find(".MoaiReverse2"),1.4*this.game.WORLD_WIDTH,0,0)},{name:"moai3",upperMoai:new e(this.el.find(".Moai3"),1.8*this.game.WORLD_WIDTH,0,180),lowerMoai:new e(this.el.find(".MoaiReverse3"),1.8*this.game.WORLD_WIDTH,0,0)}]},e=function(a,b,c,d){this.moai=a,this.pos={x:b,y:c,angle:d}};return d.prototype.reset=function(){for(var a=0;a<this.moais.length;a++){this.moais[a].upperMoai.pos.x=this.game.WORLD_WIDTH+4*a*this.game.WORLD_WIDTH/10,this.moais[a].lowerMoai.pos.x=this.game.WORLD_WIDTH+4*a*this.game.WORLD_WIDTH/10;var b=Math.floor(26*Math.random())+9;this.el[2*a].style.height=b+"em",this.el[2*a+1].style.height=this.game.WORLD_HEIGHT-b-c+"em"}this.transformMoai()},d.prototype.onFrame=function(d){if(this.player.hasStarted){a=21;for(var e=0;e<this.moais.length;e++)if(this.moais[e].upperMoai.pos.x-=d*a,this.moais[e].lowerMoai.pos.x-=d*a,this.moais[e].upperMoai.pos.x+b<0){var f=Math.floor(26*Math.random())+9;this.el[2*e].style.height=f+"em",this.el[2*e+1].style.height=this.game.WORLD_HEIGHT-f-c+"em",this.moais[e].upperMoai.pos.x=1.2*this.game.WORLD_WIDTH-b,this.moais[e].lowerMoai.pos.x=1.2*this.game.WORLD_WIDTH-b}this.transformMoai()}},d.prototype.transformMoai=function(){for(var a=0;a<this.moais.length;a++)this.el[2*a].style.transform="translate3d("+this.moais[a].upperMoai.pos.x+"em, "+this.moais[a].upperMoai.pos.y+"em, 0em) rotate("+this.moais[a].upperMoai.pos.angle+"deg)",this.el[2*a].style.MozTransform="translate3d("+this.moais[a].upperMoai.pos.x+"em, "+this.moais[a].upperMoai.pos.y+"em, 0em) rotate("+this.moais[a].upperMoai.pos.angle+"deg)",this.el[2*a].style.webkitTransform="translate3d("+this.moais[a].upperMoai.pos.x+"em, "+this.moais[a].upperMoai.pos.y+"em, 0em) rotate("+this.moais[a].upperMoai.pos.angle+"deg)",this.el[2*a+1].style.transform="translate3d("+this.moais[a].lowerMoai.pos.x+"em, "+this.moais[a].lowerMoai.pos.y+"em, 0em) rotate("+this.moais[a].lowerMoai.pos.angle+"deg)",this.el[2*a+1].style.MozTransform="translate3d("+this.moais[a].lowerMoai.pos.x+"em, "+this.moais[a].lowerMoai.pos.y+"em, 0em) rotate("+this.moais[a].lowerMoai.pos.angle+"deg)",this.el[2*a+1].style.webkitTransform="translate3d("+this.moais[a].lowerMoai.pos.x+"em, "+this.moais[a].lowerMoai.pos.y+"em, 0em) rotate("+this.moais[a].lowerMoai.pos.angle+"deg)"},d}();